Задача 1.
import RPi.GPIO as GPIO
import time

dac = [26, 19, 13, 6, 5, 11, 9, 10]
bits = len(dac)
levels = 2**bits
maxvoltage = 3.3
troykaModule = 17
comparator = 4

GPIO.setmode(GPIO.BCM)
GPIO.setup(dac, GPIO.OUT, initial = GPIO.LOW)
GPIO.setup(troykaModule, GPIO.OUT, initial = GPIO.HIGH)
GPIO.setup(comparator, GPIO.IN)

def decimal2binary(decimal):
return [int(bit) for bit in bin(decimal)[2☺.zfill(bits)]

def num2dac(value):
signal = decimal2binary(value)
GPIO.output(dac, signal)
return signal

try:
while True:

for value in range(256):
time.sleep(0.002)
signal = num2dac(value)
voltage = value / levels * maxvoltage
comparatorvalue = GPIO.input(comparator)
if comparatorvalue == 0:
print ("ADC value = {:^3} -> {}, input voltage = {:.2f}". format (value , signal, voltage))
break

except KeyboardInterrupt:
print(" Программа приостановлена с клавиатуры")
else:
pass
finally:
GPIO.output(dac, GPIO.LOW)
GPIO.cleanup(dac)
print("Проведена чистка")

Задача 2.
import RPi.GPIO as GPIO
import time

dac = [26, 19, 13, 6, 5, 11, 9, 10]
bits = len(dac)
levels = 2**bits
maxvoltage = 3.3
troykaModule = 17
comparator = 4

def dec2bin(dec):
return [int(bit) for bit in bin(dec)[2☺.zfill(8)]

def dec2dac(dec):
GPIO.output(dac, dec2bin(dec))

def adc():
ans = 0
for i in range(8):
ans = ans + 2**(7-i)
dec2dac(ans)
time.sleep(0.001)
if GPIO.input(4) == 0:
ans = ans -2**(7-i)
print("Value is {:^3} Voltage is {:.2f}".format(ans, ans/255*3,3))

GPIO.setmode(GPIO.BCM)
GPIO.setup(dac, GPIO.OUT, initial = GPIO.LOW)
GPIO.setup(troykaModule, GPIO.OUT, initial = GPIO.HIGH)
GPIO.setup(comparator, GPIO.IN)

try:
while True:
adc()

finally:
GPIO.output(dac, GPIO.LOW)
GPIO.cleanup(dac)
print("Проведена чистка")
